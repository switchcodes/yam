# Build and Test Application

name: Build and Test

on:
  workflow_call:
    inputs:
      os:
        description: 'The os to test on'
        required: true
        default: 'ubuntu-latest'
      node-v:
        description: 'The node version'
        required: true
        default: '16.x'
      workdir:
        description: 'The working directory'
        required: true
        default: '.'

jobs:
  perform-build:
    name: Build and Test application
    runs-on: ${{ inputs.os }}
    steps:
    - uses: actions/checkout@v3
    - name: Setting up Node.js ${{ inputs.node-v }}
      uses: actions/setup-node@v3
      with:
        node-version: ${{ inputs.node-v }}
        cache: 'npm'
        cache-dependency-path: '**/package-lock.json'
    - name: Install dependencies
      working-directory: ${{ inputs.workdir }}
      run: npm 
    - name: Building ${{ inputs.workdir }} App
      working-directory: ${{ inputs.workdir }}
      run: npm run build --if-present
    - name: Testing ${{ inputs.workdir }} App
      working-directory: ${{ inputs.workdir }}
      run: npm test
      
        